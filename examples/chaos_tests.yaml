# Chaos Tests Example Configuration
# 
# This configuration uses environment variables for all metadata fields.
# Set the following environment variables before running Orion:
# Example usage:
# export version=4.19
# export scenario_type=time_scenarios
# export cloud_infrastructure=AWS
# export cloud_type=self-managed
# export total_node_count=9
# export node_instance_type="*xlarge*"
# export network_plugins=OVNKubernetes
# export scenario_file="*time_scenario.yaml"
# orion cmd --config examples/chaos_tests.yaml --hunter-analyze

metricsFile: metrics/chaos-scenarios-metrics.yaml
tests:
  - name: krkn-hub-*
    version_field: cluster_version
    uuid_field: run_uuid
    metadata:
      cluster_version: "{{ version }}"
      scenarios.scenario_type: "{{ scenario_type }}"
      cloud_infrastructure: "{{ cloud_infrastructure }}"
      cloud_type: "{{ cloud_type }}"
      total_node_count: "{{ total_node_count }}"
      node_summary_infos.instance_type: "{{ node_instance_type }}"
      network_plugins: "{{ network_plugins }}"
      scenarios.scenario: "{{ scenario_file }}"
    metrics:
      # Recovery & Health metrics
      - name: health_check_recovery
        threshold: 15
        direction: 1
        metricName.keyword: health_check_recovery
        metric_of_interest: duration
        not:
          status_code: 200
        agg:
          value: duration
          agg_type: sum
