# Node Scenarios Configuration
# This configuration is based on verified metrics from UUID: 221c11c1-0d6f-4790-acdd-40118b954f1c
# Requires environment variables for dynamic configuration
# Example usage:
# export version=4.19
# export scenario_type=node_scenarios
# export cloud_infrastructure=AWS
# export cloud_type=self-managed
# export total_node_count=9
# export node_instance_type="*xlarge*"
# export network_plugins=OVNKubernetes
# export scenario_file="*time_scenario.yaml"
# orion cmd --config examples/node_scenarios.yaml --lookback 10d

metricsFile: metrics/chaos-scenarios-metrics.yaml
tests:
  - name: krkn-hub-*
    version_field: cluster_version
    uuid_field: run_uuid
    metadata:
      cluster_version: "{{ version }}"
      scenarios.scenario_type: "{{ scenario_type }}"
      cloud_infrastructure: "{{ cloud_infrastructure }}"
      cloud_type: "{{ cloud_type }}"
      total_node_count: "{{ total_node_count }}"
      network_plugins: "{{ network_plugins }}"
      scenarios.scenario: "{{ scenario_file }}"
      scenarios.exit_status: 0
      scenarios.parameters.node_scenarios.label_selector: "{{ label_selector }}"
    metrics:
      # Recovery & Health metrics
      - name: affected_nodes_recovery
        threshold: 15
        direction: 1
        metricName.keyword: affected_nodes_recovery
        metric_of_interest: ready_time
        agg:
          value: ready_time
          agg_type: avg
